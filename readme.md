# hh2mc

Адаптер для проксирования запросов из HTTP-заголовков в формат memcached.

Принимет HTTP-запросы, где в  HTTP-заголовках (Memcached-Key, Memcached-Value, Memcached-Time) указываются значения передаваемые в memcached.
Ответ из memcached так же возвращаетя в HTTP-заголовках.
Метод GET для запроса значений, POST для записи значений в memcached.
Позврашаются коды HTTP-статуса: 200 - при удачных запросах/записях данных, 400-599 - при не нахождении значений, и др. ошибках.

Изначально предназначалось для возможности записи из nginx в memcached значений сесионной информации.

Написано на Python-е, компилируется [py2bin](https://github.com/editorbank/py2bin)-ом в единый независимый от установок Python-а бинарный файл.
Бинарный файл заварачивается в Docker-образ на основе чистой Ubuntu.

## Требования к среде сборки

* ОС Linux семейства Ubuntu
* Установленный Docker или Podman

## Настройка

Среду поддержки образов можно указать в переменой `docker` указав в значении `podman` или `docker` в файлах `config.sh` и `py2bin.sh`.
Там же можно указать имя контейнера и образ.


## Сборка

Для (пере)сборки образа выполните команду:

```
./build.sh
```
## Проверка

Получившийся образ можно увидеть командой
```
docker images -f reference=hh2mc
```
запустить образ с командой подсказки аргументов
```
docker run -it --rm --name hh2mc docker.io/editorbank/hh2mc:latest /hh2mc.bin --help
```
запустить образ с полученим запросов по порту 8080 и перенаправлением на memcached на порт 8211 на этом же компютере
```
docker run -it --rm --name hh2mc docker.io/editorbank/hh2mc:latest /hh2mc.bin 127.0.0.1:8080 127.0.0.1:8211
```
